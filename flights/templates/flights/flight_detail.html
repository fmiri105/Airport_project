{% extends 'flights/base.html' %}

{% block title %}جزئیات پرواز - {{ flight.name }}{% endblock %}

{% block content %}
<div class="card mx-auto w-75 shadow">
    <div class="card-body">
        <div class="d-flex justify-content-between align-items-start mb-4">
            <h3 class="card-title">{{ flight.name }}</h3>
            {% if is_flight_manager %}
                <div class="btn-group" role="group">
                    <a href="#" class="btn btn-warning btn-sm">ویرایش</a>
                    <a href="#" class="btn btn-danger btn-sm">حذف</a>
                </div>
            {% endif %}
        </div>
        
        <div class="row">
            <div class="col-md-6">
                <p><strong>مبدا:</strong> {{ flight.origin.name }} ({{ flight.origin.code }}) — {{ flight.origin.city.name }}</p>
            </div>
            <div class="col-md-6">
                <p><strong>مقصد:</strong> {{ flight.destination.name }} ({{ flight.destination.code }}) — {{ flight.destination.city.name }}</p>
            </div>
        </div>
        
        <p><strong>فاصله:</strong> {{ flight.distance_km }} کیلومتر</p>
        <p><strong>تعداد مسافران فعلی:</strong> 
            <span class="badge bg-primary fs-6">{{ flight.passengers.count }}</span>
        </p>

        {% if user.is_authenticated %}
            <form method="post" action="{% url 'register_flight' flight.id %}">
                {% csrf_token %}
                <button type="submit" class="btn btn-success w-100">
                    <i class="fas fa-ticket-alt me-2"></i>ثبت‌نام در این پرواز
                </button>
            </form>
                {% if is_manager %}
                <div class="mt-3">
                    <a href="{% url 'flight_passengers' flight.id %}" class="btn btn-secondary ms-1">مسافران</a>
                    <a href="{% url 'flight_edit' flight.id %}" class="btn btn-warning ms-1">ویرایش</a>
                    <a href="{% url 'flight_delete' flight.id %}" class="btn btn-danger ms-1">حذف</a>
                </div>
                {% endif %}
        {% else %}
            <div class="alert alert-info mt-3">
                برای ثبت‌نام در این پرواز، <a href="{% url 'login' %}" class="alert-link">وارد شوید</a>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}
